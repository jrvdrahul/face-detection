{"ast":null,"code":"import _classCallCheck from \"/code/face-recog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/code/face-recog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/code/face-recog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/code/face-recog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/code/face-recog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/code/face-recog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _regeneratorRuntime from \"/code/face-recog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/code/face-recog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/code/face-recog/src/views/examples/Face.jsx\";\nimport React from \"react\";\nimport * as bodyPix from \"@tensorflow-models/body-pix\";\nimport Stats from \"stats.js\";\nimport * as partColorScales from \"../../part_color_scales\";\nimport { Card, CardHeader, CardBody, Container, Row, Col, Button, Modal, ModalHeader, ModalBody, ModalFooter } from \"reactstrap\";\nimport Header from \"components/Headers/Header.jsx\";\nimport axios from \"axios\"; //import socketIOClient from \"socket.io-client\";\n\nimport GlobalConfig from \"../../config\";\nimport Loader from \"./Loader\"; //const socket = socketIOClient(GlobalConfig.backendURL);\n\nvar hide = {\n  display: \"none\"\n};\nvar screenshot = {\n  width: \"200px\"\n};\nvar urlParams = window.location.pathname;\nvar s = urlParams.split(\"/\");\nvar randomId = s[s.length - 1];\nvar stats = new Stats();\nvar state = {\n  video: null,\n  stream: null,\n  net: null,\n  videoConstraints: {},\n  changingCamera: false,\n  changingArchitecture: false\n};\n\nfunction isAndroid() {\n  return /Android/i.test(navigator.userAgent);\n}\n\nfunction isiOS() {\n  return /iPhone|iPad|iPod/i.test(navigator.userAgent);\n}\n\nfunction isMobile() {\n  return isAndroid() || isiOS();\n}\n\nfunction getVideoInputs() {\n  return _getVideoInputs.apply(this, arguments);\n}\n\nfunction _getVideoInputs() {\n  _getVideoInputs = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2() {\n    var devices, videoDevices;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!(!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices)) {\n              _context2.next = 2;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", []);\n\n          case 2:\n            _context2.next = 4;\n            return navigator.mediaDevices.enumerateDevices();\n\n          case 4:\n            devices = _context2.sent;\n            videoDevices = devices.filter(function (device) {\n              return device.kind === \"videoinput\";\n            });\n            return _context2.abrupt(\"return\", videoDevices);\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _getVideoInputs.apply(this, arguments);\n}\n\nfunction stopExistingVideoCapture() {\n  if (state.video && state.video.srcObject) {\n    state.video.srcObject.getTracks().forEach(function (track) {\n      track.stop();\n    });\n    state.video.srcObject = null;\n  }\n}\n\nfunction getConstraints(_x) {\n  return _getConstraints.apply(this, arguments);\n}\n\nfunction _getConstraints() {\n  _getConstraints = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(cameraLabel) {\n    var deviceId, facingMode;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!cameraLabel) {\n              _context3.next = 5;\n              break;\n            }\n\n            _context3.next = 3;\n            return getDeviceIdForLabel(cameraLabel);\n\n          case 3:\n            deviceId = _context3.sent;\n            facingMode = isMobile() ? getFacingMode(cameraLabel) : null;\n\n          case 5:\n            return _context3.abrupt(\"return\", {\n              deviceId: deviceId,\n              facingMode: facingMode\n            });\n\n          case 6:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _getConstraints.apply(this, arguments);\n}\n\nfunction getDeviceIdForLabel(_x2) {\n  return _getDeviceIdForLabel.apply(this, arguments);\n}\n\nfunction _getDeviceIdForLabel() {\n  _getDeviceIdForLabel = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee4(cameraLabel) {\n    var videoInputs, i, videoInput;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return getVideoInputs();\n\n          case 2:\n            videoInputs = _context4.sent;\n            i = 0;\n\n          case 4:\n            if (!(i < videoInputs.length)) {\n              _context4.next = 11;\n              break;\n            }\n\n            videoInput = videoInputs[i];\n\n            if (!(videoInput.label === cameraLabel)) {\n              _context4.next = 8;\n              break;\n            }\n\n            return _context4.abrupt(\"return\", videoInput.deviceId);\n\n          case 8:\n            i++;\n            _context4.next = 4;\n            break;\n\n          case 11:\n            return _context4.abrupt(\"return\", null);\n\n          case 12:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _getDeviceIdForLabel.apply(this, arguments);\n}\n\nfunction getFacingMode(cameraLabel) {\n  if (!cameraLabel) {\n    return \"user\";\n  }\n\n  if (cameraLabel.toLowerCase().includes(\"back\")) {\n    return \"environment\";\n  } else {\n    return \"user\";\n  }\n}\n\nvar s1 = null;\n\nfunction setupCamera(_x3) {\n  return _setupCamera.apply(this, arguments);\n}\n\nfunction _setupCamera() {\n  _setupCamera = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee5(cameraLabel) {\n    var videoElement, videoConstraints, stream;\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            if (!(!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia)) {\n              _context5.next = 2;\n              break;\n            }\n\n            throw new Error(\"Browser API navigator.mediaDevices.getUserMedia not available\");\n\n          case 2:\n            videoElement = document.getElementById(\"video\");\n            stopExistingVideoCapture();\n            _context5.next = 6;\n            return getConstraints(cameraLabel);\n\n          case 6:\n            videoConstraints = _context5.sent;\n            _context5.next = 9;\n            return navigator.mediaDevices.getUserMedia({\n              audio: false,\n              video: videoConstraints\n            });\n\n          case 9:\n            stream = _context5.sent;\n            videoElement.srcObject = stream;\n            s1 = stream;\n            return _context5.abrupt(\"return\", new Promise(function (resolve) {\n              videoElement.onloadedmetadata = function () {\n                videoElement.width = videoElement.videoWidth;\n                videoElement.height = videoElement.videoHeight;\n                resolve(videoElement);\n              };\n            }));\n\n          case 13:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n  return _setupCamera.apply(this, arguments);\n}\n\nfunction loadVideo(_x4) {\n  return _loadVideo.apply(this, arguments);\n}\n\nfunction _loadVideo() {\n  _loadVideo = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee6(cameraLabel) {\n    var info;\n    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.prev = 0;\n            _context6.next = 3;\n            return setupCamera(cameraLabel);\n\n          case 3:\n            state.video = _context6.sent;\n            _context6.next = 12;\n            break;\n\n          case 6:\n            _context6.prev = 6;\n            _context6.t0 = _context6[\"catch\"](0);\n            info = document.getElementById(\"info\");\n            info.textContent = \"this browser does not support video capture,\" + \"or this device does not have a camera\";\n            info.style.display = \"block\";\n            throw _context6.t0;\n\n          case 12:\n            state.video.play();\n\n          case 13:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6, null, [[0, 6]]);\n  }));\n  return _loadVideo.apply(this, arguments);\n}\n\nvar guiState = {\n  camera: null,\n  flipHorizontal: true,\n  input: {\n    mobileNetArchitecture: isMobile() ? \"0.50\" : \"0.75\",\n    outputStride: 16\n  },\n  partMap: {\n    colorScale: \"rainbow\",\n    segmentationThreshold: 0.5\n  }\n};\n\nfunction segmentBodyInRealTime() {\n  // function drawVideoFrame(time) {\n  //   const canvas = document.getElementById(\"output\");\n  //   var video = document.getElementById(\"video\");\n  //   var CANVAS_WIDTH = canvas.width;\n  //   var CANVAS_HEIGHT = canvas.height;\n  //   var ctxv = canvas.getContext(\"2d\");\n  //   ctxv.drawImage(video, 0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n  //   var a = canvas.toDataURL(\"image/png\", 1);\n  //   var videoObject = {\n  //     frame: a,\n  //     personId: randomId.toString()\n  //   };\n  //   //socket.emit(\"frames\", videoObject);\n  // }\n  var l1 = \"false\";\n  var l2 = \"false\";\n  var l3 = \"false\";\n  var r1 = \"false\";\n  var r2 = \"false\";\n  var r3 = \"false\";\n  var center = \"false\";\n  var complete = \"false\";\n  var canvas = document.getElementById(\"output\");\n  var seq = [\"0\", \"1\", \"0\", \"1\", \"2\"];\n  var a = 0;\n\n  function bodySegmentationFrame() {\n    return _bodySegmentationFrame.apply(this, arguments);\n  }\n\n  function _bodySegmentationFrame() {\n    _bodySegmentationFrame = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var outputStride, flipHorizontally, partSegmentation, values, total, leftPoints, rightPoints, face, leftFace, rightFace, getLeftFace, getRightFace, getCenterFace, s, coloredPartImageData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              getCenterFace = function _ref3() {\n                if (face > 40 && leftFace > 25 && rightFace > 25 && center == \"false\") {\n                  capture(\"center\");\n                  a++;\n                  document.getElementById(\"centerface\").style.display = \"none\";\n                }\n              };\n\n              getRightFace = function _ref2() {\n                if (rightFace > 25 && rightFace < 30 && r1 == \"false\") {\n                  r1 = \"true\";\n                  capture(\"right\");\n                }\n\n                if (rightFace > 30 && rightFace < 35 && r2 == \"false\") {\n                  r2 = \"true\";\n                  capture(\"right\");\n                }\n\n                if (rightFace > 35 && rightFace < 40 && r3 == \"false\") {\n                  r3 = \"true\";\n                  capture(\"right\");\n                }\n\n                if (rightFace > 40 && r1 == \"true\" && r2 == \"true\" && r3 == \"true\") {\n                  capture(\"right\");\n                  a++;\n                  document.getElementById(\"wayToRight\").style.display = \"none\";\n                }\n              };\n\n              getLeftFace = function _ref() {\n                if (leftFace > 25 && leftFace < 30 && l1 == \"false\") {\n                  l1 = \"true\";\n                  capture(\"left\");\n                }\n\n                if (leftFace > 30 && leftFace < 35 && l2 == \"false\") {\n                  l2 = \"true\";\n                  capture(\"left\");\n                }\n\n                if (leftFace > 35 && leftFace < 40 && l3 == \"false\") {\n                  l3 = \"true\";\n                  capture(\"left\");\n                }\n\n                if (leftFace > 40 && l1 == \"true\" && l2 == \"true\" && l3 == \"true\") {\n                  capture(\"left\");\n                  a++;\n                  document.getElementById(\"wayToLeft\").style.display = \"none\";\n                }\n              };\n\n              if (!(state.changingArchitecture || state.changingCamera)) {\n                _context.next = 6;\n                break;\n              }\n\n              setTimeout(bodySegmentationFrame, 1000);\n              return _context.abrupt(\"return\");\n\n            case 6:\n              stats.begin();\n              outputStride = +guiState.input.outputStride;\n              flipHorizontally = guiState.flipHorizontal;\n              _context.next = 11;\n              return state.net.estimatePartSegmentation(state.video, outputStride, guiState.partMap.segmentationThreshold);\n\n            case 11:\n              partSegmentation = _context.sent;\n              values = Object.values(partSegmentation.data);\n              total = values.filter(function (pt) {\n                return pt != -1;\n              }).length;\n              leftPoints = values.filter(function (pt) {\n                return pt === 0;\n              }).length;\n              rightPoints = values.filter(function (pt) {\n                return pt === 1;\n              }).length;\n              face = (leftPoints + rightPoints) * 100 / total;\n              leftFace = leftPoints * 100 / total;\n              rightFace = rightPoints * 100 / total;\n\n              if (face < 40) {\n                document.getElementById(\"faceCover\").style.display = \"block\";\n              } else {\n                document.getElementById(\"faceCover\").style.display = \"none\";\n              }\n\n              for (s = 0; s < seq.length; s++) {\n                if (seq[a] == 0) {\n                  document.getElementById(\"wayToLeft\").style.display = \"block\";\n                  getLeftFace();\n                }\n\n                if (seq[a] == 1) {\n                  document.getElementById(\"wayToRight\").style.display = \"block\";\n                  getRightFace();\n                }\n\n                if (seq[a] == 2) {\n                  document.getElementById(\"centerface\").style.display = \"block\";\n                  getCenterFace();\n                }\n\n                if (seq.length == [a] && complete == \"false\") {\n                  s1.getTracks()[0].stop(); //socket.emit(\"stopVideo\", randomId.toString());\n\n                  navigator.getUserMedia = null;\n                  complete = \"true\";\n                  state.video.pause();\n                  document.getElementById(\"main\").style.display = \"none\";\n                  document.getElementById(\"face-images\").style.display = \"block\";\n                  window.helloComponent.hitApi(randomId); //window.helloComponent.toggle();\n                  //socket.close();\n                }\n              }\n\n              coloredPartImageData = bodyPix.toColoredPartImageData(partSegmentation, partColorScales[guiState.partMap.colorScale]);\n              bodyPix.drawMask(canvas, state.video, coloredPartImageData, flipHorizontally); //drawVideoFrame();\n\n              stats.end();\n              requestAnimationFrame(bodySegmentationFrame);\n\n            case 25:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _bodySegmentationFrame.apply(this, arguments);\n  }\n\n  bodySegmentationFrame();\n}\n\nexport function bindPage() {\n  return _bindPage.apply(this, arguments);\n}\n\nfunction _bindPage() {\n  _bindPage = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee7() {\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            _context7.next = 2;\n            return bodyPix.load(+guiState.input.mobileNetArchitecture);\n\n          case 2:\n            state.net = _context7.sent;\n            document.getElementById(\"loading\").style.display = \"none\";\n            document.getElementById(\"main\").style.display = \"inline-block\";\n            _context7.next = 7;\n            return loadVideo();\n\n          case 7:\n            //let cameras = await getVideoInputs();\n            segmentBodyInRealTime();\n\n          case 8:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n  return _bindPage.apply(this, arguments);\n}\n\nfunction capture(_x5) {\n  return _capture.apply(this, arguments);\n}\n\nfunction _capture() {\n  _capture = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee8(value) {\n    var canvas, video, ctx, dataURI, b64toBlob, formdata, config;\n    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            canvas = document.getElementById(value);\n            video = document.getElementById(\"video\");\n            canvas.width = 400;\n            canvas.height = 400;\n            ctx = canvas.getContext(\"2d\");\n            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n            dataURI = canvas.toDataURL(\"video/webm\", 1);\n\n            b64toBlob = function b64toBlob(b64Data) {\n              var contentType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n              var sliceSize = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 512;\n              var byteCharacters = window.atob(b64Data.replace(/^data:image\\/(png|jpeg|jpg);base64,/, \"\"));\n              var byteArrays = [];\n\n              for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n                var slice = byteCharacters.slice(offset, offset + sliceSize);\n                var byteNumbers = new Array(slice.length);\n\n                for (var i = 0; i < slice.length; i++) {\n                  byteNumbers[i] = slice.charCodeAt(i);\n                }\n\n                var byteArray = new Uint8Array(byteNumbers);\n                byteArrays.push(byteArray);\n              }\n\n              var blob = new Blob(byteArrays, {\n                type: contentType\n              });\n              return blob;\n            };\n\n            formdata = new FormData();\n            formdata.append(\"personId\", randomId.toString());\n            formdata.append(\"image\", b64toBlob(dataURI, \"image/png\"));\n            config = {\n              headers: {\n                \"content-type\": \"multipart/form-data\"\n              }\n            };\n            axios.post(GlobalConfig.backendURL + \"/api/v1/image\", formdata, config).then(function (res) {//console.log(res);\n            });\n\n          case 13:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  }));\n  return _capture.apply(this, arguments);\n}\n\nvar Index =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Index, _React$Component);\n\n  function Index(props) {\n    var _this;\n\n    _classCallCheck(this, Index);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Index).call(this, props));\n    _this.state = {\n      instruction: \"\",\n      modal: false,\n      loader: false\n    };\n    window.helloComponent = _assertThisInitialized(_this);\n    _this.toggle = _this.toggle.bind(_assertThisInitialized(_this));\n    _this.hitApi = _this.hitApi.bind(_assertThisInitialized(_this));\n    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n    bindPage();\n    return _this;\n  }\n\n  _createClass(Index, [{\n    key: \"loader\",\n    value: function loader() {\n      if (this.state.loader) {\n        return React.createElement(Loader, {\n          message: \"Recording your data\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 412\n          },\n          __self: this\n        });\n      }\n    }\n  }, {\n    key: \"hitApi\",\n    value: function hitApi(id) {\n      var _this2 = this;\n\n      var intervalHandle = null;\n      var data = {\n        personId: id\n      };\n      this.setState({\n        loader: true\n      });\n      axios.post(GlobalConfig.backendURL + \"/api/v1/person/face\", data).then(function (response) {\n        if (response.status = true) {\n          axios.post(GlobalConfig.backendURL + \"/api/v1/person/train/start/\").then(function (response) {\n            intervalHandle = setInterval(function () {\n              axios.get(GlobalConfig.backendURL + \"/api/v1/person/train/status/\").then(function (response) {\n                if (response.data.data.status == \"succeeded\") {\n                  clearInterval(intervalHandle);\n\n                  _this2.setState({\n                    loader: false\n                  });\n\n                  _this2.toggle();\n                }\n              }).catch(function (error) {\n                throw error;\n              });\n            }, 2000);\n          }).catch(function (error) {\n            throw error;\n          });\n        }\n      }).catch(function (error) {\n        throw error;\n      });\n    }\n  }, {\n    key: \"toggle\",\n    value: function toggle() {\n      if (this.state.modal == true) {\n        this.close();\n      }\n\n      this.setState(function (prevState) {\n        return {\n          modal: !prevState.modal\n        };\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      window.location = \"/admin/index\";\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var instruction = this.state.instruction;\n      return React.createElement(React.Fragment, null, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 476\n        },\n        __self: this\n      }), React.createElement(Container, {\n        className: \"mt--7\",\n        fluid: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 477\n        },\n        __self: this\n      }, this.loader(), React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 479\n        },\n        __self: this\n      }, React.createElement(Col, {\n        className: \"mb-5 mb-xl-0\",\n        xl: \"12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 480\n        },\n        __self: this\n      }, React.createElement(Card, {\n        className: \"shadow\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 481\n        },\n        __self: this\n      }, React.createElement(CardHeader, {\n        className: \"bg-transparent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 482\n        },\n        __self: this\n      }, React.createElement(Row, {\n        className: \"align-items-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 483\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 484\n        },\n        __self: this\n      }, instruction, React.createElement(\"div\", {\n        style: hide,\n        id: \"faceCover\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 486\n        },\n        __self: this\n      }, \"PLease come closer to the screen\"), React.createElement(\"div\", {\n        style: hide,\n        id: \"centerface\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 489\n        },\n        __self: this\n      }, \"Slowly move your head towards center\"), React.createElement(\"div\", {\n        style: hide,\n        id: \"wayToLeft\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 492\n        },\n        __self: this\n      }, \"Slowly move your head towards right\"), React.createElement(\"div\", {\n        style: hide,\n        id: \"wayToRight\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 495\n        },\n        __self: this\n      }, \"Slowly move your head towards left\"), React.createElement(\"div\", {\n        style: hide,\n        id: \"allDone\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 498\n        },\n        __self: this\n      }, \"All Done\")))), React.createElement(CardBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 504\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 505\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"stats\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 506\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        id: \"info\",\n        style: {\n          display: \"none\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 507\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        id: \"loading\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 508\n        },\n        __self: this\n      }, \"Loading the model...\"), React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 510\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"main\",\n        className: \"col-md-7\",\n        style: {\n          display: \"none\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 511\n        },\n        __self: this\n      }, React.createElement(\"video\", {\n        id: \"video\",\n        playsInline: true,\n        style: {\n          width: \"inherit\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 516\n        },\n        __self: this\n      }), React.createElement(\"canvas\", {\n        id: \"output\",\n        style: hide,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 521\n        },\n        __self: this\n      }), React.createElement(\"canvas\", {\n        id: \"output1\",\n        style: hide,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 522\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"col-md-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 524\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"face-images col-md-4\",\n        id: \"face-images\",\n        style: hide,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 525\n        },\n        __self: this\n      }, React.createElement(\"canvas\", {\n        id: \"left\",\n        style: screenshot,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 530\n        },\n        __self: this\n      }), React.createElement(\"canvas\", {\n        id: \"center\",\n        style: screenshot,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 531\n        },\n        __self: this\n      }), React.createElement(\"canvas\", {\n        id: \"right\",\n        style: screenshot,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 532\n        },\n        __self: this\n      })), React.createElement(Modal, {\n        isOpen: this.state.modal,\n        toggle: this.toggle,\n        className: this.props.className,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 535\n        },\n        __self: this\n      }, React.createElement(ModalHeader, {\n        toggle: this.toggle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 540\n        },\n        __self: this\n      }, \"Complete - ID: \", randomId), React.createElement(ModalBody, {\n        style: {\n          textAlign: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 543\n        },\n        __self: this\n      }, React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 544\n        },\n        __self: this\n      }, \"Face Verification Complete\")), React.createElement(ModalFooter, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 546\n        },\n        __self: this\n      }, React.createElement(Button, {\n        color: \"secondary\",\n        onClick: function onClick() {\n          return _this3.close();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 547\n        },\n        __self: this\n      }, \"close\")))))))))));\n    }\n  }]);\n\n  return Index;\n}(React.Component);\n\nexport default Index;","map":{"version":3,"sources":["/code/face-recog/src/views/examples/Face.jsx"],"names":["React","bodyPix","Stats","partColorScales","Card","CardHeader","CardBody","Container","Row","Col","Button","Modal","ModalHeader","ModalBody","ModalFooter","Header","axios","GlobalConfig","Loader","hide","display","screenshot","width","urlParams","window","location","pathname","s","split","randomId","length","stats","state","video","stream","net","videoConstraints","changingCamera","changingArchitecture","isAndroid","test","navigator","userAgent","isiOS","isMobile","getVideoInputs","mediaDevices","enumerateDevices","devices","videoDevices","filter","device","kind","stopExistingVideoCapture","srcObject","getTracks","forEach","track","stop","getConstraints","cameraLabel","getDeviceIdForLabel","deviceId","facingMode","getFacingMode","videoInputs","i","videoInput","label","toLowerCase","includes","s1","setupCamera","getUserMedia","Error","videoElement","document","getElementById","audio","Promise","resolve","onloadedmetadata","videoWidth","height","videoHeight","loadVideo","info","textContent","style","play","guiState","camera","flipHorizontal","input","mobileNetArchitecture","outputStride","partMap","colorScale","segmentationThreshold","segmentBodyInRealTime","l1","l2","l3","r1","r2","r3","center","complete","canvas","seq","a","bodySegmentationFrame","getLeftFace","getRightFace","getCenterFace","face","leftFace","rightFace","capture","setTimeout","begin","flipHorizontally","estimatePartSegmentation","partSegmentation","values","Object","data","total","pt","leftPoints","rightPoints","pause","helloComponent","hitApi","coloredPartImageData","toColoredPartImageData","drawMask","end","requestAnimationFrame","bindPage","load","value","ctx","getContext","drawImage","dataURI","toDataURL","b64toBlob","b64Data","contentType","sliceSize","byteCharacters","atob","replace","byteArrays","offset","slice","byteNumbers","Array","charCodeAt","byteArray","Uint8Array","push","blob","Blob","type","formdata","FormData","append","toString","config","headers","post","backendURL","then","res","Index","props","instruction","modal","loader","toggle","bind","webkitGetUserMedia","mozGetUserMedia","id","intervalHandle","personId","setState","response","status","setInterval","get","clearInterval","catch","error","close","prevState","className","textAlign","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport * as bodyPix from \"@tensorflow-models/body-pix\";\nimport Stats from \"stats.js\";\nimport * as partColorScales from \"../../part_color_scales\";\nimport {\n  Card,\n  CardHeader,\n  CardBody,\n  Container,\n  Row,\n  Col,\n  Button,\n  Modal,\n  ModalHeader,\n  ModalBody,\n  ModalFooter\n} from \"reactstrap\";\nimport Header from \"components/Headers/Header.jsx\";\nimport axios from \"axios\";\n//import socketIOClient from \"socket.io-client\";\nimport GlobalConfig from \"../../config\";\nimport Loader from \"./Loader\";\n\n//const socket = socketIOClient(GlobalConfig.backendURL);\nconst hide = {\n  display: \"none\"\n};\n\nconst screenshot = {\n  width: \"200px\"\n};\n\nconst urlParams = window.location.pathname;\nconst s = urlParams.split(\"/\");\nconst randomId = s[s.length - 1];\n\nconst stats = new Stats();\n\nconst state = {\n  video: null,\n  stream: null,\n  net: null,\n  videoConstraints: {},\n  changingCamera: false,\n  changingArchitecture: false\n};\n\nfunction isAndroid() {\n  return /Android/i.test(navigator.userAgent);\n}\n\nfunction isiOS() {\n  return /iPhone|iPad|iPod/i.test(navigator.userAgent);\n}\n\nfunction isMobile() {\n  return isAndroid() || isiOS();\n}\n\nasync function getVideoInputs() {\n  if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {\n    return [];\n  }\n\n  const devices = await navigator.mediaDevices.enumerateDevices();\n\n  const videoDevices = devices.filter(device => device.kind === \"videoinput\");\n\n  return videoDevices;\n}\n\nfunction stopExistingVideoCapture() {\n  if (state.video && state.video.srcObject) {\n    state.video.srcObject.getTracks().forEach(track => {\n      track.stop();\n    });\n    state.video.srcObject = null;\n  }\n}\n\nasync function getConstraints(cameraLabel) {\n  let deviceId;\n  let facingMode;\n\n  if (cameraLabel) {\n    deviceId = await getDeviceIdForLabel(cameraLabel);\n    facingMode = isMobile() ? getFacingMode(cameraLabel) : null;\n  }\n  return { deviceId, facingMode };\n}\nasync function getDeviceIdForLabel(cameraLabel) {\n  const videoInputs = await getVideoInputs();\n\n  for (let i = 0; i < videoInputs.length; i++) {\n    const videoInput = videoInputs[i];\n    if (videoInput.label === cameraLabel) {\n      return videoInput.deviceId;\n    }\n  }\n\n  return null;\n}\n\nfunction getFacingMode(cameraLabel) {\n  if (!cameraLabel) {\n    return \"user\";\n  }\n  if (cameraLabel.toLowerCase().includes(\"back\")) {\n    return \"environment\";\n  } else {\n    return \"user\";\n  }\n}\nvar s1 = null;\nasync function setupCamera(cameraLabel) {\n  if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n    throw new Error(\n      \"Browser API navigator.mediaDevices.getUserMedia not available\"\n    );\n  }\n\n  const videoElement = document.getElementById(\"video\");\n\n  stopExistingVideoCapture();\n\n  const videoConstraints = await getConstraints(cameraLabel);\n\n  const stream = await navigator.mediaDevices.getUserMedia({\n    audio: false,\n    video: videoConstraints\n  });\n  videoElement.srcObject = stream;\n  s1 = stream;\n  return new Promise(resolve => {\n    videoElement.onloadedmetadata = () => {\n      videoElement.width = videoElement.videoWidth;\n      videoElement.height = videoElement.videoHeight;\n      resolve(videoElement);\n    };\n  });\n}\n\nasync function loadVideo(cameraLabel) {\n  try {\n    state.video = await setupCamera(cameraLabel);\n  } catch (e) {\n    let info = document.getElementById(\"info\");\n    info.textContent =\n      \"this browser does not support video capture,\" +\n      \"or this device does not have a camera\";\n    info.style.display = \"block\";\n    throw e;\n  }\n\n  state.video.play();\n}\n\nconst guiState = {\n  camera: null,\n  flipHorizontal: true,\n  input: {\n    mobileNetArchitecture: isMobile() ? \"0.50\" : \"0.75\",\n    outputStride: 16\n  },\n  partMap: {\n    colorScale: \"rainbow\",\n    segmentationThreshold: 0.5\n  }\n};\n\nfunction segmentBodyInRealTime() {\n  // function drawVideoFrame(time) {\n  //   const canvas = document.getElementById(\"output\");\n  //   var video = document.getElementById(\"video\");\n\n  //   var CANVAS_WIDTH = canvas.width;\n  //   var CANVAS_HEIGHT = canvas.height;\n  //   var ctxv = canvas.getContext(\"2d\");\n  //   ctxv.drawImage(video, 0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n  //   var a = canvas.toDataURL(\"image/png\", 1);\n  //   var videoObject = {\n  //     frame: a,\n  //     personId: randomId.toString()\n  //   };\n  //   //socket.emit(\"frames\", videoObject);\n  // }\n\n  var l1 = \"false\";\n  var l2 = \"false\";\n  var l3 = \"false\";\n  var r1 = \"false\";\n  var r2 = \"false\";\n  var r3 = \"false\";\n  var center = \"false\";\n  var complete = \"false\";\n  const canvas = document.getElementById(\"output\");\n\n  var seq = [\"0\", \"1\", \"0\", \"1\", \"2\"];\n  var a = 0;\n\n  async function bodySegmentationFrame() {\n    if (state.changingArchitecture || state.changingCamera) {\n      setTimeout(bodySegmentationFrame, 1000);\n      return;\n    }\n\n    stats.begin();\n    const outputStride = +guiState.input.outputStride;\n\n    const flipHorizontally = guiState.flipHorizontal;\n\n    const partSegmentation = await state.net.estimatePartSegmentation(\n      state.video,\n      outputStride,\n      guiState.partMap.segmentationThreshold\n    );\n\n    const values = Object.values(partSegmentation.data);\n\n    var total = values.filter(pt => pt != -1).length;\n    var leftPoints = values.filter(pt => pt === 0).length;\n    var rightPoints = values.filter(pt => pt === 1).length;\n\n    var face = ((leftPoints + rightPoints) * 100) / total;\n    var leftFace = (leftPoints * 100) / total;\n    var rightFace = (rightPoints * 100) / total;\n\n    if (face < 40) {\n      document.getElementById(\"faceCover\").style.display = \"block\";\n    } else {\n      document.getElementById(\"faceCover\").style.display = \"none\";\n    }\n\n    function getLeftFace() {\n      if (leftFace > 25 && leftFace < 30 && l1 == \"false\") {\n        l1 = \"true\";\n        capture(\"left\");\n      }\n      if (leftFace > 30 && leftFace < 35 && l2 == \"false\") {\n        l2 = \"true\";\n        capture(\"left\");\n      }\n      if (leftFace > 35 && leftFace < 40 && l3 == \"false\") {\n        l3 = \"true\";\n        capture(\"left\");\n      }\n      if (leftFace > 40 && l1 == \"true\" && l2 == \"true\" && l3 == \"true\") {\n        capture(\"left\");\n        a++;\n        document.getElementById(\"wayToLeft\").style.display = \"none\";\n      }\n    }\n    function getRightFace() {\n      if (rightFace > 25 && rightFace < 30 && r1 == \"false\") {\n        r1 = \"true\";\n        capture(\"right\");\n      }\n      if (rightFace > 30 && rightFace < 35 && r2 == \"false\") {\n        r2 = \"true\";\n        capture(\"right\");\n      }\n      if (rightFace > 35 && rightFace < 40 && r3 == \"false\") {\n        r3 = \"true\";\n        capture(\"right\");\n      }\n      if (rightFace > 40 && r1 == \"true\" && r2 == \"true\" && r3 == \"true\") {\n        capture(\"right\");\n        a++;\n\n        document.getElementById(\"wayToRight\").style.display = \"none\";\n      }\n    }\n    function getCenterFace() {\n      if (face > 40 && leftFace > 25 && rightFace > 25 && center == \"false\") {\n        capture(\"center\");\n        a++;\n        document.getElementById(\"centerface\").style.display = \"none\";\n      }\n    }\n\n    for (var s = 0; s < seq.length; s++) {\n      if (seq[a] == 0) {\n        document.getElementById(\"wayToLeft\").style.display = \"block\";\n        getLeftFace();\n      }\n      if (seq[a] == 1) {\n        document.getElementById(\"wayToRight\").style.display = \"block\";\n        getRightFace();\n      }\n      if (seq[a] == 2) {\n        document.getElementById(\"centerface\").style.display = \"block\";\n        getCenterFace();\n      }\n      if (seq.length == [a] && complete == \"false\") {\n        s1.getTracks()[0].stop();\n        //socket.emit(\"stopVideo\", randomId.toString());\n        navigator.getUserMedia = null;\n        complete = \"true\";\n        state.video.pause();\n        document.getElementById(\"main\").style.display = \"none\";\n        document.getElementById(\"face-images\").style.display = \"block\";\n\n        window.helloComponent.hitApi(randomId);\n\n        //window.helloComponent.toggle();\n        //socket.close();\n      }\n    }\n\n    const coloredPartImageData = bodyPix.toColoredPartImageData(\n      partSegmentation,\n      partColorScales[guiState.partMap.colorScale]\n    );\n\n    bodyPix.drawMask(\n      canvas,\n      state.video,\n      coloredPartImageData,\n      flipHorizontally\n    );\n\n    //drawVideoFrame();\n    stats.end();\n    requestAnimationFrame(bodySegmentationFrame);\n  }\n\n  bodySegmentationFrame();\n}\n\nexport async function bindPage() {\n  state.net = await bodyPix.load(+guiState.input.mobileNetArchitecture);\n\n  document.getElementById(\"loading\").style.display = \"none\";\n  document.getElementById(\"main\").style.display = \"inline-block\";\n\n  await loadVideo();\n\n  //let cameras = await getVideoInputs();\n\n  segmentBodyInRealTime();\n}\n\nasync function capture(value) {\n  var canvas = document.getElementById(value);\n  var video = document.getElementById(\"video\");\n  canvas.width = 400;\n  canvas.height = 400;\n  var ctx = canvas.getContext(\"2d\");\n  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n  var dataURI = canvas.toDataURL(\"video/webm\", 1);\n\n  const b64toBlob = (b64Data, contentType = \"\", sliceSize = 512) => {\n    const byteCharacters = window.atob(\n      b64Data.replace(/^data:image\\/(png|jpeg|jpg);base64,/, \"\")\n    );\n    const byteArrays = [];\n\n    for (let offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n      const slice = byteCharacters.slice(offset, offset + sliceSize);\n\n      const byteNumbers = new Array(slice.length);\n      for (let i = 0; i < slice.length; i++) {\n        byteNumbers[i] = slice.charCodeAt(i);\n      }\n\n      const byteArray = new Uint8Array(byteNumbers);\n      byteArrays.push(byteArray);\n    }\n\n    const blob = new Blob(byteArrays, { type: contentType });\n    return blob;\n  };\n\n  let formdata = new FormData();\n  formdata.append(\"personId\", randomId.toString());\n\n  formdata.append(\"image\", b64toBlob(dataURI, \"image/png\"));\n\n  const config = {\n    headers: {\n      \"content-type\": \"multipart/form-data\"\n    }\n  };\n  axios\n    .post(GlobalConfig.backendURL + \"/api/v1/image\", formdata, config)\n    .then(res => {\n      //console.log(res);\n    });\n}\n\nclass Index extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      instruction: \"\",\n      modal: false,\n      loader: false\n    };\n    window.helloComponent = this;\n    this.toggle = this.toggle.bind(this);\n    this.hitApi = this.hitApi.bind(this);\n\n    navigator.getUserMedia =\n      navigator.getUserMedia ||\n      navigator.webkitGetUserMedia ||\n      navigator.mozGetUserMedia;\n    bindPage();\n  }\n\n  loader() {\n    if (this.state.loader) {\n      return <Loader message=\"Recording your data\" />;\n    }\n  }\n\n  hitApi(id) {\n    var intervalHandle = null;\n    const data = {\n      personId: id\n    };\n\n    this.setState({\n      loader: true\n    });\n    axios\n      .post(GlobalConfig.backendURL + \"/api/v1/person/face\", data)\n      .then(response => {\n        if ((response.status = true)) {\n          axios\n            .post(GlobalConfig.backendURL + \"/api/v1/person/train/start/\")\n            .then(response => {\n              intervalHandle = setInterval(() => {\n                axios\n                  .get(GlobalConfig.backendURL + \"/api/v1/person/train/status/\")\n                  .then(response => {\n                    if (response.data.data.status == \"succeeded\") {\n                      clearInterval(intervalHandle);\n                      this.setState({\n                        loader: false\n                      });\n                      this.toggle();\n                    }\n                  })\n                  .catch(error => {\n                    throw error;\n                  });\n              }, 2000);\n            })\n            .catch(error => {\n              throw error;\n            });\n        }\n      })\n      .catch(error => {\n        throw error;\n      });\n  }\n\n  toggle() {\n    if (this.state.modal == true) {\n      this.close();\n    }\n    this.setState(prevState => ({\n      modal: !prevState.modal\n    }));\n  }\n\n  close() {\n    window.location = \"/admin/index\";\n  }\n\n  render() {\n    const instruction = this.state.instruction;\n    return (\n      <>\n        <Header />\n        <Container className=\"mt--7\" fluid>\n          {this.loader()}\n          <Row>\n            <Col className=\"mb-5 mb-xl-0\" xl=\"12\">\n              <Card className=\"shadow\">\n                <CardHeader className=\"bg-transparent\">\n                  <Row className=\"align-items-center\">\n                    <div className=\"col\">\n                      {instruction}\n                      <div style={hide} id=\"faceCover\">\n                        PLease come closer to the screen\n                      </div>\n                      <div style={hide} id=\"centerface\">\n                        Slowly move your head towards center\n                      </div>\n                      <div style={hide} id=\"wayToLeft\">\n                        Slowly move your head towards right\n                      </div>\n                      <div style={hide} id=\"wayToRight\">\n                        Slowly move your head towards left\n                      </div>\n                      <div style={hide} id=\"allDone\">\n                        All Done\n                      </div>\n                    </div>\n                  </Row>\n                </CardHeader>\n                <CardBody>\n                  <div>\n                    <div id=\"stats\" />\n                    <div id=\"info\" style={{ display: \"none\" }} />\n                    <div id=\"loading\">Loading the model...</div>\n\n                    <Row>\n                      <div\n                        id=\"main\"\n                        className=\"col-md-7\"\n                        style={{ display: \"none\" }}\n                      >\n                        <video\n                          id=\"video\"\n                          playsInline\n                          style={{ width: \"inherit\" }}\n                        />\n                        <canvas id=\"output\" style={hide} />\n                        <canvas id=\"output1\" style={hide} />\n                      </div>\n                      <div className=\"col-md-1\" />\n                      <div\n                        className=\"face-images col-md-4\"\n                        id=\"face-images\"\n                        style={hide}\n                      >\n                        <canvas id=\"left\" style={screenshot} />\n                        <canvas id=\"center\" style={screenshot} />\n                        <canvas id=\"right\" style={screenshot} />\n                      </div>\n\n                      <Modal\n                        isOpen={this.state.modal}\n                        toggle={this.toggle}\n                        className={this.props.className}\n                      >\n                        <ModalHeader toggle={this.toggle}>\n                          Complete - ID: {randomId}\n                        </ModalHeader>\n                        <ModalBody style={{ textAlign: \"center\" }}>\n                          <b>Face Verification Complete</b>\n                        </ModalBody>\n                        <ModalFooter>\n                          <Button\n                            color=\"secondary\"\n                            onClick={() => this.close()}\n                          >\n                            close\n                          </Button>\n                        </ModalFooter>\n                      </Modal>\n                    </Row>\n                  </div>\n                </CardBody>\n              </Card>\n            </Col>\n          </Row>\n        </Container>\n      </>\n    );\n  }\n}\n\nexport default Index;\n"]},"metadata":{},"sourceType":"module"}